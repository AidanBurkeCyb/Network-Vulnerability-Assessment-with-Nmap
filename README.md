# Network-Vulnerability-Assessment-with-Nmap

this project will be particularly useful for anyone who is using an M chip macbook, and using UTM as a VM.

## Project Description
This project aims to demonstrate the use of Nmap, a powerful network scanning tool, to identify vulnerabilities within a controlled environment using Metasploitable, a deliberately vulnerable virtual machine on UTM with a Mac running an M1 pro chip. Through various Nmap scanning techniques, this project will uncover live hosts, open ports, and the services running on those hosts, ultimately assessing the security posture of the network. The findings will be documented and presented in a comprehensive report, providing insights into potential vulnerabilities and recommendations for remediation. This project serves as a practical example for those interested in network security and vulnerability assessment.

## Objectives
- Identify live hosts on the network.
- Discover open ports and services running on those hosts.
- Assess vulnerabilities using Nmap scripts.

- ## Tools Used
- **M1 MacBook:** The host machine used for the project.
- **UTM:** Virtual machine software to run Metasploitable.
- **Homebrew:** Package manager for installing Nmap and other tools.
- **QEMU:** Used for converting the Metasploitable VMDK file to QCOW format.
- **Metasploitable:** Deliberately vulnerable virtual machine for testing.
- **Nmap:** Network scanning tool for vulnerability assessment.

## Prerequisites
- **Metasploitable VM:** [Instructions for converting the VMDK to a QCOW file and setting it up in UTM.](https://www.youtube.com/watch?v=E3IJ_d3rAgA&t=224s)
- **Nmap:** Instructions for installing Nmap on your host machine.

# Tools to Install
Before starting this project, run the following commands to install all the necessary tools:

  ## Homebew
  ```bash
  Install Homebrew
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
  ```

  ## Install QEMU
  ```bash
  brew install qemu
  ```
  ## Install UTM
  ```bash
  brew install --cask utm
  ```
  ## Install Nmap
  ```bash
  brew install nmap
  ```
  # Download Metasploitable
  https://sourceforge.net/projects/metasploitable/

# Steps

- **1** \- I scanned for live hosts on the network
  ```bash
  nmap -sn <ip address>
  ```

- **2** \- I identified the Metasploitable virtual machines IP address by running the following command
  ```bash
  ifconfig
  ```
  Look for and take note of the IP address under the eth0 interface

- **3** \- I performed a vulnerability scan on all live hosts using Nmap Scripting Engine (NSE), looking to keep an eye out for the IP of the vulnerable VM.
  ```bash
  nmap -Pn --script=vuln <192.xxx.x.x/x>
  ```
- **4** \- Retrieve the results in text format
  Upon reviewing the return of the last command I can see that all IPs past a certain numerical value don't return anything. So I will run the scan again to return the IPs that had appeared in the vulnerability scan, and export them to a .txt file called vulnerability scans result.
  ```bash
  nmap -Pn --script=vuln <192.xxx.xxx.0-3> -oN vulnerability_scan_results.txt
  ```
- **5** \- Analyse the Vulnerabilities found in the .txt file.
- Overview of vulnerabilities from the scan
  Detailed vulnerability findings

## Conclusion

The vulnerability scan of my network indicates that there is one device with critical vulnerabilities. This was the Metasploitable machine with an IP address of (`192.168.128.3`). The most significant findings include:

1. **vsFTPd 2.3.4 Backdoor (CVE-2011-2523)**: This vulnerability allows attackers to execute arbitrary commands and gain root access to the system.
   
2. **SSL POODLE Vulnerability (CVE-2014-3566)**: The SSL 3.0 protocol is vulnerable to a man-in-the-middle attack, allowing attackers to decrypt sensitive information.
   
3. **Diffie-Hellman Key Exchange Weakness**: Weak Diffie-Hellman group sizes allow passive eavesdropping and man-in-the-middle attacks on encrypted communications.

4. **RMI Registry Remote Code Execution**: The RMI registry service allows loading remote classes, leading to potential remote code execution.
   
5. **SQL Injection in Mutillidae**: The Mutillidae web application hosted on the machine shows multiple potential SQL injection points, enabling attackers to manipulate the backend database.
   
6. **Slowloris Denial of Service (CVE-2007-6750)**: The HTTP server is likely vulnerable to a Slowloris DoS attack, which can exhaust server resources and make it unavailable.

---

## Recommendations

1. **Patch and Upgrade Services**:
   - Update or replace **vsFTPd** with a secure version to mitigate the backdoor vulnerability.
   - Disable SSL 3.0 and configure the server to use only modern protocols such as **TLS 1.2** or **TLS 1.3** to address the SSL POODLE vulnerability.
   - Upgrade **RMI registry** configurations to prevent remote class loading.

2. **Enhance Encryption**:
   - Use stronger Diffie-Hellman group sizes (at least 2048-bit) to protect against eavesdropping attacks.
   
3. **Web Application Security**:
   - Review and fix the SQL injection vulnerabilities in the **Mutillidae** application by using prepared statements or other SQL sanitisation techniques.
   - Implement **Cross-Site Request Forgery (CSRF)** protection mechanisms for all forms in the web application.

4. **Harden the Server**:
   - Disable unnecessary services like **Telnet** and **rlogin**.
   - Consider firewalls or intrusion detection systems (IDS) to monitor traffic and prevent exploitation of known vulnerabilities like the **Slowloris attack**.

---

By applying these recommendations, the risk of exploitation on the Metasploitable machine can be significantly reduced.

  
  




