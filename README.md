# Network-Vulnerability-Assessment-with-Nmap

this project will be particularly useful for anyone who is using an M chip macbook, and using UTM as a VM.

## Project Description
This project aims to demonstrate the use of Nmap, a powerful network scanning tool, to identify vulnerabilities within a controlled environment using Metasploitable, a deliberately vulnerable virtual machine on UTM with a Mac running an M1 pro chip. Through various Nmap scanning techniques, this project will uncover live hosts, open ports, and the services running on those hosts, ultimately assessing the security posture of the network. The findings will be documented and presented in a comprehensive report, providing insights into potential vulnerabilities and recommendations for remediation. This project serves as a practical example for those interested in network security and vulnerability assessment.

## Objectives
- Identify live hosts on the network.
- Discover open ports and services running on those hosts.
- Assess vulnerabilities using Nmap scripts.

- ## Tools Used
- **M1 MacBook:** The host machine used for the project.
- **UTM:** Virtual machine software to run Metasploitable.
- **Homebrew:** Package manager for installing Nmap and other tools.
- **QEMU:** Used for converting the Metasploitable VMDK file to QCOW format.
- **Metasploitable:** Deliberately vulnerable virtual machine for testing.
- **Nmap:** Network scanning tool for vulnerability assessment.

## Prerequisites
- **Metasploitable VM:** [Instructions for converting the VMDK to a QCOW file and setting it up in UTM.](https://www.youtube.com/watch?v=E3IJ_d3rAgA&t=224s)
- **Nmap:** Instructions for installing Nmap on your host machine.

# Tools to Install
Before starting this project, run the following commands to install all the necessary tools:

  ## Homebew
  ```bash
  Install Homebrew
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
  ```

  ## Install QEMU
  ```bash
  brew install qemu
  ```
  ## Install UTM
  ```bash
  brew install --cask utm
  ```
  ## Install Nmap
  ```bash
  brew install nmap
  ```
  # Download Metasploitable
  https://sourceforge.net/projects/metasploitable/

# Steps

- **1** \- I scanned for live hosts on the network
  ```bash
  nmap -sn <ip address>
  ```
  [Scan Results](https://github.com/AidanBurkeCyb/Network-Vulnerability-Assessment-with-Nmap/blob/main/1.%20Initial%20Scan%20of%20Entire%20Network.png?raw=true)

- **2** \- I identified the Metasploitable virtual machines IP address by running the following command
  ```bash
  ifconfig
  ```
  Look for and take note of the IP address under the eth0 interface

  [Metasploitable VM IP](https://github.com/AidanBurkeCyb/Network-Vulnerability-Assessment-with-Nmap/blob/main/2.%20Scan%20to%20find%20Metasploitables%20VM%20ip.png?raw=true)

- **3** \- I performed a vulnerability scan on all live hosts using Nmap Scripting Engine (NSE) I kept an eye out for the IP of the vulnerable VM.
  ```bash
  nmap -Pn --script=vuln <192.xxx.x.x/x>
  ```
  [Scan Results with NSE](https://github.com/AidanBurkeCyb/Network-Vulnerability-Assessment-with-Nmap/blob/main/3.%20Vulnerability%20Scan%20on%20all%20Live%20Hosts.png?raw=true)
  
- **4** \- Retrieve the results in text format
  Upon reviewing the return of the last command, I can see that all IPs past a certain numerical value don't return anything. So I will run the scan again to return the IPs that had appeared in the vulnerability scan, and export them to a .txt file called vulnerability scans result with the following command.
  ```bash
  nmap -Pn --script=vuln <192.xxx.xxx.0-3> -oN vulnerability_scan_results.txt
  ```
  [Full Vulnerability Scan txt file](vulnerability_scan_results.txt)
  
- **5** \- Analyse the Vulnerabilities found in the .txt file.
- Overview of vulnerabilities from the scan
  Detailed vulnerability findings

## Conclusion

The vulnerability scan of my network indicates that there is one device with critical vulnerabilities. This was, as expected, the Metasploitable machine with the IP address (`192.168.128.3`). The most significant findings include:

- **21/tcp - FTP (vsFTPd 2.3.4)**
  - **Vulnerability**: vsFTPd 2.3.4 backdoor vulnerability (CVE-2011-2523) allows attackers to execute arbitrary commands and gain root access to the system.
  - **Exploit**: Attackers can use the backdoor to issue root-level commands and take complete control over the machine.

- **25/tcp - SMTP**
  - **Vulnerability**: SSL POODLE vulnerability (CVE-2014-3566) allows man-in-the-middle attackers to decrypt sensitive data by exploiting SSL 3.0.
  - **Exploit**: Attackers can intercept and decrypt secure communications, potentially exposing confidential information.

- **80/tcp - HTTP and 8180/tcp - Apache Tomcat**
  - **Vulnerability**: The HTTP server is vulnerable to a Slowloris Denial of Service (DoS) attack (CVE-2007-6750).
  - **Exploit**: Attackers can exhaust server resources by opening incomplete HTTP connections, rendering the server unavailable.

- **23/tcp - Telnet**
  - **Vulnerability**: Telnet transmits data, including credentials, in plain text, making it highly vulnerable to interception.
  - **Exploit**: Attackers can intercept login credentials or sensitive data by eavesdropping on the network.

- **512/tcp - rlogin**
  - **Vulnerability**: rlogin also transmits credentials in plain text, making it vulnerable to interception.
  - **Exploit**: Similar to Telnet, attackers can capture and read login credentials or other sensitive information.

- **1099/tcp - RMI Registry**
  - **Vulnerability**: The RMI registry service is vulnerable to remote code execution due to the ability to load remote classes (CVE-2013-1537).
  - **Exploit**: Attackers can use this vulnerability to execute arbitrary code on the machine, potentially leading to full system compromise.

- **6667/tcp - UnrealIRCd**
  - **Vulnerability**: A trojaned version of **UnrealIRCd** was found, which could allow remote code execution.
  - **Exploit**: Attackers can take control of the IRC service and execute commands remotely.

- **SQL Injection in Mutillidae**
  - **Vulnerability**: Multiple possible SQL injection points were found in the **Mutillidae** web application.
  - **Exploit**: Attackers can manipulate the backend database by injecting malicious SQL queries.

- **Cross-Site Request Forgery (CSRF) in Mutillidae**
  - **Vulnerability**: CSRF vulnerabilities were identified in multiple forms within the **Mutillidae** application.
  - **Exploit**: Attackers can trick users into performing actions they did not intend, leading to account compromise or other malicious activities.

- **Diffie-Hellman Weak Key Exchange**
  - **Vulnerability**: Weak Diffie-Hellman key exchange makes services using TLS susceptible to man-in-the-middle attacks.
  - **Exploit**: Attackers can intercept encrypted communications and potentially decrypt them.

- **SSL/TLS MITM (CCS Injection)**
  - **Vulnerability**: An SSL/TLS vulnerability (CVE-2014-0224) allows attackers to perform a man-in-the-middle attack by injecting crafted ChangeCipherSpec messages.
  - **Exploit**: Attackers can interfere with the secure communication, making it vulnerable to interception and modification.

## Recommendations

## Recommendations

To mitigate the vulnerabilities found during the scan, the following actions are recommended:

1. **Patch and Upgrade Services**:
   - **vsFTPd**: Upgrade or replace vsFTPd 2.3.4 to a secure version to close the backdoor vulnerability (CVE-2011-2523).
   - **UnrealIRCd**: Replace the trojaned version of UnrealIRCd with a secure and verified version to prevent remote code execution (CVE-2010-2075).
   - **RMI Registry**: Configure the RMI registry to prevent the loading of remote classes and update the service to address remote code execution vulnerabilities (CVE-2013-1537).
   
2. **Harden Encryption Protocols**:
   - **Disable SSL 3.0**: Address the SSL POODLE vulnerability (CVE-2014-3566) by disabling SSL 3.0 and ensuring only secure protocols like **TLS 1.2** or **TLS 1.3** are used.
   - **Update Diffie-Hellman Key Exchange**: Ensure the use of strong Diffie-Hellman parameters (at least 2048-bit) to protect against man-in-the-middle attacks.
   - **Patch SSL/TLS**: Ensure all SSL/TLS services are updated to address vulnerabilities like CCS Injection (CVE-2014-0224).

3. **Disable or Replace Insecure Services**:
   - **Telnet**: Replace Telnet with secure alternatives like SSH, as Telnet transmits data in plain text.
   - **rlogin**: Disable rlogin as it also transmits credentials in plain text, or replace it with a secure protocol like SSH.
   
4. **Web Application Security**:
   - **SQL Injection in Mutillidae**: Review and fix the SQL injection vulnerabilities in the Mutillidae application by using prepared statements or sanitising user input.
   - **CSRF Protection**: Implement CSRF tokens in forms across the Mutillidae application to prevent cross-site request forgery attacks.
   
5. **Harden the Web Server**:
   - **HTTP (Slowloris DoS)**: Protect the web server from Slowloris attacks (CVE-2007-6750) by configuring the server to limit the number of connections from a single IP or use a firewall to block such attacks.

6. **General System Hardening**:
   - **Remove Unnecessary Services**: Disable or remove services that are not required, such as **rlogin**, **Telnet**, and other insecure protocols.
   - **Install Firewalls**: Implement a firewall or intrusion detection system (IDS) to monitor traffic and block malicious activity.
   - **Regular Patching**: Ensure that all services and software on the machine are regularly updated to avoid known vulnerabilities.

---

By applying these recommendations, the risk of exploitation on the Metasploitable machine can be significantly reduced.
